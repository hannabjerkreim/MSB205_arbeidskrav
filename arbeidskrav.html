<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Romlig analyse av boligpriser i King County</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="arbeidskrav_files/libs/clipboard/clipboard.min.js"></script>
<script src="arbeidskrav_files/libs/quarto-html/quarto.js"></script>
<script src="arbeidskrav_files/libs/quarto-html/popper.min.js"></script>
<script src="arbeidskrav_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="arbeidskrav_files/libs/quarto-html/anchor.min.js"></script>
<link href="arbeidskrav_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="arbeidskrav_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="arbeidskrav_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="arbeidskrav_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="arbeidskrav_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Romlig analyse av boligpriser i King County</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p><strong>1. House Sales King County, USA fra Kaggle</strong></p>
<p>ny tekst</p>
<p><strong>2. WADOH Environmental Health Disparities Index Calculated for King County</strong></p>
<p><strong>3. Gjør en «spatial join» av husdata med tracts10</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial join mellom husdata og tracts10</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tracts10_join <span class="ot">&lt;-</span> <span class="fu">st_join</span>(kc_house_data, tracts10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sjekk områdevariablene i tracts10</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tracts10_join)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      id                 date                             year     
 Length:21436       Min.   :2014-05-02 00:00:00.00   Min.   :2014  
 Class :character   1st Qu.:2014-07-22 00:00:00.00   1st Qu.:2014  
 Mode  :character   Median :2014-10-17 00:00:00.00   Median :2014  
                    Mean   :2014-10-29 17:30:02.34   Mean   :2014  
                    3rd Qu.:2015-02-18 00:00:00.00   3rd Qu.:2015  
                    Max.   :2015-05-27 00:00:00.00   Max.   :2015  
                                                                   
     month             day                 geometry        zipcode     
 Min.   : 1.000   Min.   : 1.00   POINT        :21436   Min.   :98001  
 1st Qu.: 4.000   1st Qu.: 8.00   epsg:2926    :    0   1st Qu.:98033  
 Median : 6.000   Median :16.00   +proj=lcc ...:    0   Median :98065  
 Mean   : 6.564   Mean   :15.69                         Mean   :98078  
 3rd Qu.: 9.000   3rd Qu.:23.00                         3rd Qu.:98117  
 Max.   :12.000   Max.   :31.00                         Max.   :98199  
                                                                       
     price            dist_cbd.V1         floors         bedrooms     
 Min.   :  75000   Min.   : 0.98600   Min.   :1.000   Min.   : 0.000  
 1st Qu.: 324866   1st Qu.: 9.78459   1st Qu.:1.000   1st Qu.: 3.000  
 Median : 450000   Median :16.54715   Median :1.500   Median : 3.000  
 Mean   : 541650   Mean   :18.48321   Mean   :1.496   Mean   : 3.372  
 3rd Qu.: 645000   3rd Qu.:25.32035   3rd Qu.:2.000   3rd Qu.: 4.000  
 Max.   :7700000   Max.   :77.31409   Max.   :3.500   Max.   :33.000  
                                                                      
   bathrooms      sqft_living    sqft_living15     sqft_lot      
 Min.   :0.000   Min.   :  290   Min.   : 399   Min.   :    520  
 1st Qu.:1.750   1st Qu.: 1430   1st Qu.:1490   1st Qu.:   5040  
 Median :2.250   Median : 1920   Median :1840   Median :   7614  
 Mean   :2.117   Mean   : 2083   Mean   :1988   Mean   :  15136  
 3rd Qu.:2.500   3rd Qu.: 2550   3rd Qu.:2370   3rd Qu.:  10696  
 Max.   :8.000   Max.   :13540   Max.   :6210   Max.   :1651359  
                                                                 
   sqft_lot15       sqft_above   sqft_basement       yr_built   
 Min.   :   651   Min.   : 290   Min.   :   0.0   Min.   :1900  
 1st Qu.:  5100   1st Qu.:1200   1st Qu.:   0.0   1st Qu.:1952  
 Median :  7620   Median :1560   Median :   0.0   Median :1975  
 Mean   : 12786   Mean   :1791   Mean   : 291.7   Mean   :1971  
 3rd Qu.: 10087   3rd Qu.:2220   3rd Qu.: 560.0   3rd Qu.:1997  
 Max.   :871200   Max.   :9410   Max.   :4820.0   Max.   :2015  
                                                                
  yr_renovated       condition        grade             view       
 Min.   :   0.00   Min.   :1.00   Min.   : 1.000   Min.   :0.0000  
 1st Qu.:   0.00   1st Qu.:3.00   1st Qu.: 7.000   1st Qu.:0.0000  
 Median :   0.00   Median :3.00   Median : 7.000   Median :0.0000  
 Mean   :  84.73   Mean   :3.41   Mean   : 7.662   Mean   :0.2351  
 3rd Qu.:   0.00   3rd Qu.:4.00   3rd Qu.: 8.000   3rd Qu.:0.0000  
 Max.   :2015.00   Max.   :5.00   Max.   :13.000   Max.   :4.0000  
                                                                   
   waterfront         GEOIDTRT           FEATURE_ID     TRACT_LBL        
 Min.   :0.000000   Length:21436       Min.   :10153   Length:21436      
 1st Qu.:0.000000   Class :character   1st Qu.:34396   Class :character  
 Median :0.000000   Mode  :character   Median :44673   Mode  :character  
 Mean   :0.007604                      Mean   :38114                     
 3rd Qu.:0.000000                      3rd Qu.:45279                     
 Max.   :1.000000                      Max.   :45837                     
                                       NA's   :1                         
  TRACT_STR           TRACT_INT       TRACT_FLT      TRACT_DEL        
 Length:21436       Min.   :  100   Min.   :  1.0   Length:21436      
 Class :character   1st Qu.:10402   1st Qu.:104.0   Class :character  
 Mode  :character   Median :24702   Median :247.0   Mode  :character  
                    Mean   :21222   Mean   :212.2                     
                    3rd Qu.:31202   3rd Qu.:312.0                     
                    Max.   :32800   Max.   :328.0                     
                    NA's   :1       NA's   :1                         
  TRTLABEL_F         TRTLABEL_C         TRTLABEL_T         COUNTY_STR       
 Length:21436       Length:21436       Length:21436       Length:21436      
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
   COUNTY_INT  STATE_STR           STATE_INT    LEVEL_1         
 Min.   :33   Length:21436       Min.   :53   Length:21436      
 1st Qu.:33   Class :character   1st Qu.:53   Class :character  
 Median :33   Mode  :character   Median :53   Mode  :character  
 Mean   :33                      Mean   :53                     
 3rd Qu.:33                      3rd Qu.:53                     
 Max.   :33                      Max.   :53                     
 NA's   :1                       NA's   :1                      
   LEVEL_2            LEVEL_3            TRACT_AREA          TRACT_PERI    
 Length:21436       Length:21436       Min.   :2.792e+06   Min.   :  8012  
 Class :character   Class :character   1st Qu.:2.485e+07   1st Qu.: 23500  
 Mode  :character   Mode  :character   Median :4.124e+07   Median : 32920  
                                       Mean   :1.808e+08   Mean   : 48215  
                                       3rd Qu.:7.308e+07   3rd Qu.: 47962  
                                       Max.   :1.526e+10   Max.   :738820  
                                       NA's   :1           NA's   :1       
   LOGRECNO           Shape_area          Shape_len        EHD_percen    
 Length:21436       Min.   :2.792e+06   Min.   :  8012   Min.   :  1.00  
 Class :character   1st Qu.:2.485e+07   1st Qu.: 23500   1st Qu.: 19.00  
 Mode  :character   Median :4.124e+07   Median : 32920   Median : 41.00  
                    Mean   :1.808e+08   Mean   : 48215   Mean   : 43.63  
                    3rd Qu.:7.308e+07   3rd Qu.: 47962   3rd Qu.: 67.00  
                    Max.   :1.526e+10   Max.   :738820   Max.   :100.00  
                    NA's   :1           NA's   :1        NA's   :1       
   linguist_2       poverty_pe      transporta      unemploy_2    
 Min.   : 0.450   Min.   : 1.97   Min.   :12.00   Min.   : 1.000  
 1st Qu.: 3.120   1st Qu.: 8.93   1st Qu.:18.00   1st Qu.: 3.230  
 Median : 7.000   Median :13.60   Median :20.00   Median : 4.310  
 Mean   : 9.004   Mean   :16.65   Mean   :19.77   Mean   : 4.774  
 3rd Qu.:12.730   3rd Qu.:22.95   3rd Qu.:21.00   3rd Qu.: 6.050  
 Max.   :40.350   Max.   :75.48   Max.   :26.00   Max.   :13.620  
 NA's   :196      NA's   :1       NA's   :1       NA's   :78      
   housing_pe      traffic_pe        diesel          ozone      
 Min.   :15.14   Min.   : 0.00   Min.   : 0.14   Min.   :46.73  
 1st Qu.:25.66   1st Qu.: 0.00   1st Qu.: 5.60   1st Qu.:49.24  
 Median :30.46   Median : 0.10   Median :10.16   Median :49.97  
 Mean   :31.37   Mean   :11.52   Mean   :13.67   Mean   :51.17  
 3rd Qu.:35.73   3rd Qu.:19.14   3rd Qu.:16.88   3rd Qu.:52.32  
 Max.   :64.87   Max.   :84.98   Max.   :92.63   Max.   :62.89  
 NA's   :1       NA's   :1       NA's   :1       NA's   :1      
      PM25         toxic_rele         hazardous_        lead_perce   
 Min.   :3.787   Min.   :   823.9   Min.   :0.02303   Min.   : 0.24  
 1st Qu.:5.488   1st Qu.:  4143.8   1st Qu.:0.03985   1st Qu.: 5.34  
 Median :6.044   Median :  8750.6   Median :0.05160   Median :11.99  
 Mean   :6.002   Mean   : 17245.8   Mean   :0.07407   Mean   :16.60  
 3rd Qu.:6.579   3rd Qu.: 17237.2   3rd Qu.:0.07891   3rd Qu.:26.48  
 Max.   :7.897   Max.   :186434.6   Max.   :0.63781   Max.   :54.68  
 NA's   :1       NA's   :1          NA's   :1         NA's   :1      
   superfund         facilities       wastewater          sen_pop_pe    
 Min.   :0.03454   Min.   :0.0523   Min.   :0.0000000   Min.   :  1.00  
 1st Qu.:0.06595   1st Qu.:0.1420   1st Qu.:0.0000026   1st Qu.: 25.00  
 Median :0.11046   Median :0.2680   Median :0.0002900   Median : 48.00  
 Mean   :0.21695   Mean   :0.5246   Mean   :0.0161550   Mean   : 48.09  
 3rd Qu.:0.23841   3rd Qu.:0.7588   3rd Qu.:0.0029000   3rd Qu.: 71.00  
 Max.   :1.46778   Max.   :3.3682   Max.   :0.6400000   Max.   :100.00  
 NA's   :1         NA's   :1        NA's   :1           NA's   :1       
   socio_perc                      GEOID      
 Min.   :  1.00   1400000US53033032602:  286  
 1st Qu.: 20.00   1400000US53033032210:  236  
 Median : 43.00   1400000US53033032329:  145  
 Mean   : 44.51   1400000US53033005600:  134  
 3rd Qu.: 67.00   1400000US53033032203:  134  
 Max.   :100.00   (Other)             :20500  
 NA's   :1        NA's                :    1  
                                        TRACTLABEL      low_income   
 Census Tract 326.02, King County, Washington:  286   Min.   :  5.0  
 Census Tract 322.10, King County, Washington:  236   1st Qu.: 67.0  
 Census Tract 323.29, King County, Washington:  145   Median :102.0  
 Census Tract 322.03, King County, Washington:  134   Mean   :144.6  
 Census Tract 56, King County, Washington    :  134   3rd Qu.:191.0  
 (Other)                                     :20500   Max.   :756.0  
 NA's                                        :    1   NA's   :1      
   mid_income      high_income     andel_hvit_alene  andel_svart_alene 
 Min.   :  58.0   Min.   :  17.0   Min.   :0.09381   Min.   :0.000000  
 1st Qu.: 309.0   1st Qu.: 573.0   1st Qu.:0.57875   1st Qu.:0.007754  
 Median : 422.0   Median : 813.0   Median :0.71575   Median :0.021700  
 Mean   : 462.8   Mean   : 927.9   Mean   :0.68772   Mean   :0.051234  
 3rd Qu.: 590.0   3rd Qu.:1200.0   3rd Qu.:0.82493   3rd Qu.:0.066730  
 Max.   :1349.0   Max.   :3135.0   Max.   :0.96698   Max.   :0.354851  
 NA's   :1        NA's   :1        NA's   :1         NA's   :1         
 andel_asiatisk_alene andel_andre_alene andel_blandet      
 Min.   :0.001585     Min.   :0.00000   Min.   :0.0003978  
 1st Qu.:0.075033     1st Qu.:0.01026   1st Qu.:0.0831379  
 Median :0.124285     Median :0.02144   Median :0.1133050  
 Mean   :0.159030     Mean   :0.04178   Mean   :0.1204632  
 3rd Qu.:0.222871     3rd Qu.:0.05490   3rd Qu.:0.1519812  
 Max.   :0.625245     Max.   :0.39761   Max.   :0.4359673  
 NA's   :1            NA's   :1         NA's   :1          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fjerner observasjoner med NA-verdier i områdevariablene</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>tracts10_join <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(tracts10_join)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lag year_month som en faktor-variabel</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tracts10_join <span class="ot">&lt;-</span> tracts10_join <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_month =</span> <span class="fu">as.factor</span>(<span class="fu">format</span>(date, <span class="st">"%Y-%m"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lagre som .gpkg</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(tracts10_join, <span class="st">"house_data.gpkg"</span>, <span class="at">append=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Deleting layer `house_data' using driver `GPKG'
Writing layer `house_data' to data source `house_data.gpkg' using driver `GPKG'
Writing 21200 features with 74 fields and geometry type Point.</code></pre>
</div>
</div>
</section>
<section id="exploratory-data-analysis-eda" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis-eda"><strong>Exploratory Data Analysis (EDA)</strong></h2>
<p><strong>4. Utfør EDA i GeoDA</strong></p>
<ul>
<li>Lag et nytt prosjekt i GeoDA</li>
<li>Last inn husdataene via .gpkg filen lagret ovenfor</li>
<li>Generer en vekt fil utfra 3 og 10 nærmeste naboer</li>
<li>Prøv å finne ut hvor de små og dyre, de store og dyre, de billige og store og de små og billige boligene ligger (prøv Bivariate Morans I)</li>
<li>Dere kan eventuelt også eksperimentere med innledene SAR, SEM og lm modeller i GeoDa</li>
</ul>
<p><img src="images/clipboard-1966060883.png" class="img-fluid"></p>
<p><img src="images/clipboard-2834459025.png" class="img-fluid"></p>
<p><strong>Sammenligning av Moran’s I-verdier</strong></p>
<pre><code>•   For vektor3 (de 3 nærmeste naboene) er **Moran’s I** = 0.406.

•   For vektor10 (de 10 nærmeste naboene) er **Moran’s I** = 0.353.</code></pre>
<p><strong>Tolkning</strong>: Begge Moran’s I-verdiene er positive, noe som indikerer en positiv romlig autokorrelasjon. Dette betyr at det er en tendens for høye prisverdier å være assosiert med høye verdier for boligareal (og tilsvarende for lave verdier). Når du inkluderer flere naboer (går fra vektor3 til vektor10), reduseres styrken på den romlige autokorrelasjonen noe, noe som tyder på at den romlige sammenhengen mellom pris og størrelse er sterkere på en lokal skala.</p>
<p><strong>Skala-effekter og romlig sammenheng</strong></p>
<p>Ved å bruke vektor3 (de 3 nærmeste naboene) får du en høyere Moran’s I-verdi enn med vektor10. Dette antyder at relasjonen mellom pris og størrelse er mer markant når man ser på umiddelbare naboer.</p>
<p>Når du inkluderer flere naboer med vektor10, ser du en liten nedgang i Moran’s I. Dette kan skyldes at det romlige mønsteret er sterkest på en liten skala, og at effekten svekkes når flere, mer fjerntliggende naboer inkluderes.</p>
<p><strong>Praktisk tolkning</strong></p>
<p><strong>Lokale mønstre</strong>: De høyere Moran’s I-verdiene for vektor3 kan indikere at små grupper av boliger med høy pris og stort areal tenderer å være konsentrert i visse områder. Dette kan reflektere “hot spots” hvor dyre og store boliger samles.</p>
<p><strong>Områder med lav pris og areal</strong>: Tilsvarende kan det også finnes lokale områder (clusters) hvor boliger med lav pris og mindre areal samles.</p>
<p><strong>Større skala</strong>: Når du går over til vektor10, kan det bety at romlige sammenhenger fremdeles finnes, men er noe mindre uttalt, noe som kan indikere at pris og størrelse varierer mer på tvers av større områder.</p>
<p><strong>1. Små og Dyre Boliger</strong></p>
<pre><code>•   **Vektor3 (3 nærmeste naboer)**: Med vektor3 ser vi en sterkere autokorrelasjon.</code></pre>
<p>Små og dyre boliger vil sannsynligvis ligge i områder hvor prisene er høye til tross for mindre boligareal, og disse vil være geografisk konsentrert rundt spesifikke, mindre nabolag.</p>
<pre><code>•   **Vektor10 (10 nærmeste naboer)**: Med vektor10 ser vi en noe svakere romlig autokorrelasjon.</code></pre>
<p>Dette antyder at de små, dyre boligene er mindre konsentrert på en større skala. Dette kan bety at små og dyre boliger er litt mer spredt utover større områder, men finnes fortsatt i visse høyprissegmenter.</p>
<p><strong>2. Store og Dyre Boliger</strong></p>
<pre><code>•   **Vektor3**: Store og dyre boliger vil vises som områder hvor både pris og boligareal er høyt, og vi ser at dette er mer lokalt konsentrert når vi bruker vektor3.</code></pre>
<p>Slike “hot spots” for store, dyre boliger indikerer at visse luksuriøse nabolag kan være romlig nær hverandre.</p>
<pre><code>•   **Vektor10**: Når vi øker skalaen til de 10 nærmeste naboene, vil noen av disse dyre og store boligene fortsatt være romlig konsentrert, men det viser en mer utvidet sammenheng, som kan bety at områder med store og dyre boliger strekker seg over flere nabolag i regionen.</code></pre>
<p><strong>3. Billige og Store Boliger</strong></p>
<pre><code>•   **Vektor3**: Med vektor3 vil store, men rimelige boliger trolig ligge i spesifikke områder hvor store boliger finnes, men med lavere prisnivåer.</code></pre>
<p>Disse kan være lokalisert i utkanter eller mindre ettertraktede områder, hvor arealet er stort, men etterspørselen er lavere.</p>
<pre><code>•   **Vektor10**: Når du ser på vektor10, kan disse billige og store boligene være mer spredt og ikke nødvendigvis konsentrert.</code></pre>
<p>Dette antyder at når vi går til større skalaer, finnes det flere områder med billige, store boliger som kan spre seg over flere nabolag eller ligger i mer spredte områder.</p>
<p><strong>4. Små og Billige Boliger</strong></p>
<pre><code>•   **Vektor3**: Små og billige boliger er mest sannsynlig geografisk konsentrert i visse områder med lave priser og mindre boliger.</code></pre>
<p>Dette kan være områder med tettere bebyggelse eller mindre attraktive boliger, som kan indikere mindre nabolag med lav etterspørsel.</p>
<pre><code>•   **Vektor10**: Når vi øker skalaen til de 10 nærmeste naboene, vil disse små, billige boligene trolig finnes i mer spredte eller blandede områder.</code></pre>
<p>Vi ser at pris og størrelse fremdeles viser en positiv korrelasjon, men på en litt bredere geografisk skala, noe som kan indikere at små og rimelige boliger finnes i en bredere del av regionen.</p>
<p><strong>Oppsummering:</strong></p>
<pre><code>•   **Lokal konsentrasjon med** vektor3: Når vi ser på de 3 nærmeste naboene, får vi et tydeligere bilde av lokale “hot spots” og “cold spots” for hver av boligtypene.</code></pre>
<p>Dette betyr at små og dyre, store og dyre, store og billige, og små og billige boliger er mer lokalt konsentrert.</p>
<pre><code>•   **Mer spredt mønster med** vektor10: Når vi inkluderer de 10 nærmeste naboene, ser vi at mønstrene for boligtypene blir mer spredt.</code></pre>
<p>Dette antyder at mønstrene ikke er like sterke på en større skala, og at ulike boligtyper kan finnes i flere ulike områder over et bredere geografisk område.</p>
</section>
<section id="hedoniske-modeller" class="level2">
<h2 class="anchored" data-anchor-id="hedoniske-modeller">Hedoniske modeller</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> bedrooms <span class="sc">+</span> bathrooms <span class="sc">+</span> sqft_living <span class="sc">+</span> sqft_lot <span class="sc">+</span> floors <span class="sc">+</span> year_month, <span class="at">data =</span> tracts10_join)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ bedrooms + bathrooms + sqft_living + sqft_lot + 
    floors + year_month, data = tracts10_join)

Residuals:
     Min       1Q   Median       3Q      Max 
-1575602  -143497   -22353   102720  4140597 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        7.989e+04  9.841e+03   8.118 4.98e-16 ***
bedrooms          -5.961e+04  2.382e+03 -25.021  &lt; 2e-16 ***
bathrooms          6.795e+03  3.856e+03   1.762  0.07807 .  
sqft_living        3.156e+02  3.167e+00  99.650  &lt; 2e-16 ***
sqft_lot          -3.993e-01  4.553e-02  -8.770  &lt; 2e-16 ***
floors            -3.785e+03  3.815e+03  -0.992  0.32114    
year_month2014-06  6.016e+03  8.364e+03   0.719  0.47197    
year_month2014-07 -7.288e+03  8.327e+03  -0.875  0.38147    
year_month2014-08 -2.473e+03  8.589e+03  -0.288  0.77341    
year_month2014-09 -7.838e+03  8.785e+03  -0.892  0.37226    
year_month2014-10  6.438e+02  8.661e+03   0.074  0.94074    
year_month2014-11 -7.658e+03  9.314e+03  -0.822  0.41095    
year_month2014-12 -1.685e+04  9.195e+03  -1.833  0.06680 .  
year_month2015-01 -1.271e+04  1.041e+04  -1.222  0.22174    
year_month2015-02 -1.215e+04  9.625e+03  -1.262  0.20684    
year_month2015-03  2.403e+04  8.635e+03   2.783  0.00538 ** 
year_month2015-04  2.922e+04  8.298e+03   3.522  0.00043 ***
year_month2015-05  3.468e+04  1.198e+04   2.894  0.00381 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 257800 on 21182 degrees of freedom
Multiple R-squared:   0.51, Adjusted R-squared:  0.5096 
F-statistic:  1297 on 17 and 21182 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> bedrooms <span class="sc">+</span> bathrooms <span class="sc">+</span> sqft_living <span class="sc">+</span> sqft_lot <span class="sc">+</span> floors <span class="sc">+</span> dist_cbd[, <span class="dv">1</span>] <span class="sc">+</span> transporta <span class="sc">+</span> poverty_pe <span class="sc">+</span> year_month, <span class="at">data =</span> tracts10_join)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ bedrooms + bathrooms + sqft_living + sqft_lot + 
    floors + dist_cbd[, 1] + transporta + poverty_pe + year_month, 
    data = tracts10_join)

Residuals:
     Min       1Q   Median       3Q      Max 
-1517596  -105970   -15644    74097  4091188 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        8.455e+05  2.702e+04  31.295  &lt; 2e-16 ***
bedrooms          -4.920e+04  2.005e+03 -24.540  &lt; 2e-16 ***
bathrooms          1.934e+04  3.244e+03   5.961 2.54e-09 ***
sqft_living        2.945e+02  2.714e+00 108.515  &lt; 2e-16 ***
sqft_lot           4.285e-01  3.959e-02  10.824  &lt; 2e-16 ***
floors            -2.277e+04  3.233e+03  -7.042 1.95e-12 ***
dist_cbd[, 1]     -9.749e+03  2.183e+02 -44.666  &lt; 2e-16 ***
transporta        -2.390e+04  1.329e+03 -17.986  &lt; 2e-16 ***
poverty_pe        -7.492e+03  1.856e+02 -40.361  &lt; 2e-16 ***
year_month2014-06  1.056e+04  7.016e+03   1.505    0.132    
year_month2014-07  2.932e+03  6.987e+03   0.420    0.675    
year_month2014-08  8.832e+03  7.207e+03   1.226    0.220    
year_month2014-09  2.521e+03  7.370e+03   0.342    0.732    
year_month2014-10  7.249e+03  7.267e+03   0.998    0.319    
year_month2014-11 -2.033e+03  7.814e+03  -0.260    0.795    
year_month2014-12 -1.383e+03  7.715e+03  -0.179    0.858    
year_month2015-01  3.829e+03  8.731e+03   0.439    0.661    
year_month2015-02  1.077e+04  8.078e+03   1.333    0.183    
year_month2015-03  3.809e+04  7.245e+03   5.258 1.47e-07 ***
year_month2015-04  3.746e+04  6.961e+03   5.381 7.47e-08 ***
year_month2015-05  4.824e+04  1.005e+04   4.797 1.62e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 216300 on 21179 degrees of freedom
Multiple R-squared:  0.6553,    Adjusted R-squared:  0.6549 
F-statistic:  2013 on 20 and 21179 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> bedrooms <span class="sc">+</span> bathrooms <span class="sc">+</span> sqft_living <span class="sc">+</span> sqft_lot <span class="sc">+</span> floors <span class="sc">+</span> dist_cbd[, <span class="dv">1</span>] <span class="sc">+</span> EHD_percen <span class="sc">+</span> year_month, <span class="at">data =</span> tracts10_join)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ bedrooms + bathrooms + sqft_living + sqft_lot + 
    floors + dist_cbd[, 1] + EHD_percen + year_month, data = tracts10_join)

Residuals:
     Min       1Q   Median       3Q      Max 
-1541263  -104290   -16658    70295  4140162 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        4.053e+05  8.994e+03  45.066  &lt; 2e-16 ***
bedrooms          -4.634e+04  1.988e+03 -23.306  &lt; 2e-16 ***
bathrooms          2.029e+04  3.212e+03   6.316 2.73e-10 ***
sqft_living        2.881e+02  2.666e+00 108.069  &lt; 2e-16 ***
sqft_lot           2.230e-01  3.909e-02   5.704 1.19e-08 ***
floors            -1.889e+04  3.176e+03  -5.948 2.76e-09 ***
dist_cbd[, 1]     -1.228e+04  1.452e+02 -84.535  &lt; 2e-16 ***
EHD_percen        -2.575e+03  5.527e+01 -46.591  &lt; 2e-16 ***
year_month2014-06  1.103e+04  6.950e+03   1.587   0.1126    
year_month2014-07  3.231e+03  6.920e+03   0.467   0.6406    
year_month2014-08  7.152e+03  7.138e+03   1.002   0.3163    
year_month2014-09  1.669e+03  7.300e+03   0.229   0.8191    
year_month2014-10  9.103e+03  7.197e+03   1.265   0.2059    
year_month2014-11 -1.785e+02  7.739e+03  -0.023   0.9816    
year_month2014-12 -1.270e+02  7.642e+03  -0.017   0.9867    
year_month2015-01  8.257e+03  8.648e+03   0.955   0.3397    
year_month2015-02  1.547e+04  8.002e+03   1.933   0.0533 .  
year_month2015-03  4.055e+04  7.177e+03   5.650 1.62e-08 ***
year_month2015-04  3.925e+04  6.896e+03   5.692 1.27e-08 ***
year_month2015-05  5.157e+04  9.960e+03   5.177 2.27e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 214200 on 21180 degrees of freedom
Multiple R-squared:  0.6618,    Adjusted R-squared:  0.6615 
F-statistic:  2181 on 19 and 21180 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>Rapporter de tre modellen i en regresjonstabell (se eksemplet med modelsummary() og flextable ovenfor). Bruk robuste standard errors. Rapporter t-verdien som er det vanligste innen økonometri.</li>
<li>Test og diskuter hvilken modell som er best.</li>
</ul>
<p><strong>Sammenlign modeller basert på R-squared og justert R-squared</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)<span class="sc">$</span>r.squared  <span class="co"># Nullmodell</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5100385</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)<span class="sc">$</span>r.squared  <span class="co"># Modell 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6552635</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)<span class="sc">$</span>r.squared  <span class="co"># Modell 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6617564</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)<span class="sc">$</span>adj.r.squared  <span class="co"># Justert R-squared for nullmodellen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5096453</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared  <span class="co"># Justert R-squared for modell 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.654938</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)<span class="sc">$</span>adj.r.squared  <span class="co"># Justert R-squared for modell 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6614529</code></pre>
</div>
</div>
<p><strong>Sammenlign modeller basert på AIC og BIC</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model1, model2, model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
model1 19 588488.8
model2 22 581042.0
model3 21 580636.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model1, model2, model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       df      BIC
model1 19 588640.0
model2 22 581217.1
model3 21 580804.1</code></pre>
</div>
</div>
<p><strong>Residualanalyse med plot() for å vurdere modellens egenskaper</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># For å vise alle fire plott i én visning</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model1)  <span class="co"># Nullmodell</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="arbeidskrav_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model2)  <span class="co"># Modell 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="arbeidskrav_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3)  <span class="co"># Modell 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="arbeidskrav_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Etter å ha analysert R-squared, AIC/BIC, og residualplott, kan du diskutere hvilken modell som er best ut fra følgende:</p>
<pre><code>•   **Forklaringskraft**: Har modellen høy R-squared eller justert R-squared?

•   **Kompleksitet vs. ytelse**: Gir AIC/BIC-resultatene en god balanse mellom kompleksitet og nøyaktighet?

•   **Residualplott**: Viser modellen tegn til systematiske feil eller uteliggere?</code></pre>
<p><strong>6. Simultan test på tids-dummiene</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simultan test på tids-dummiene for Model 1</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>test_result1 <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(model1, <span class="fu">matchCoefs</span>(model1, <span class="st">"year_month"</span>), <span class="at">white.adjust =</span> <span class="st">"hc3"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Resultat for Model 1:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Resultat for Model 1:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_result1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Linear hypothesis test:
year_month2014-06
year_month2014-07
year_month2014-08
year_month2014-09
year_month2014-10
year_month2014-11
year_month2014-12
year_month2015-01
year_month2015-02
year_month2015-03
year_month2015-04
year_month2015-05

Model 1: restricted model
Model 2: price ~ bedrooms + bathrooms + sqft_living + sqft_lot + floors + 
    year_month

Note: Coefficient covariance matrix supplied.

  Res.Df Df     F    Pr(&gt;F)    
1  21194                       
2  21182 12 5.717 6.082e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simultan test på tids-dummiene for Model 2</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>test_result2 <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(model2, <span class="fu">matchCoefs</span>(model2, <span class="st">"year_month"</span>), <span class="at">white.adjust =</span> <span class="st">"hc3"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Resultat for Model 2:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Resultat for Model 2:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_result2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Linear hypothesis test:
year_month2014-06
year_month2014-07
year_month2014-08
year_month2014-09
year_month2014-10
year_month2014-11
year_month2014-12
year_month2015-01
year_month2015-02
year_month2015-03
year_month2015-04
year_month2015-05

Model 1: restricted model
Model 2: price ~ bedrooms + bathrooms + sqft_living + sqft_lot + floors + 
    dist_cbd[, 1] + transporta + poverty_pe + year_month

Note: Coefficient covariance matrix supplied.

  Res.Df Df      F    Pr(&gt;F)    
1  21191                        
2  21179 12 8.2016 1.245e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simultan test på tids-dummiene for Model 3</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>test_result3 <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(model3, <span class="fu">matchCoefs</span>(model3, <span class="st">"year_month"</span>), <span class="at">white.adjust =</span> <span class="st">"hc3"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Resultat for Model 3:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Resultat for Model 3:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_result3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Linear hypothesis test:
year_month2014-06
year_month2014-07
year_month2014-08
year_month2014-09
year_month2014-10
year_month2014-11
year_month2014-12
year_month2015-01
year_month2015-02
year_month2015-03
year_month2015-04
year_month2015-05

Model 1: restricted model
Model 2: price ~ bedrooms + bathrooms + sqft_living + sqft_lot + floors + 
    dist_cbd[, 1] + EHD_percen + year_month

Note: Coefficient covariance matrix supplied.

  Res.Df Df      F    Pr(&gt;F)    
1  21192                        
2  21180 12 9.1943 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Tolkning av resultatene for hver modell</strong></p>
<p><strong>Model 1</strong></p>
<pre><code>•   **F-verdi**: 5.717

•   **p-verdi**: 6.082e-10 (som er ekstremt lav, mindre enn 0.001)</code></pre>
<p>For Model 1 indikerer den lave p-verdien (p &lt; 0.001) at vi kan avvise nullhypotesen om at alle tids-dummiene samlet er lik null. Dette betyr at tids-dummiene har en signifikant effekt på modellens forklaringskraft, og de bør inkluderes i modellen.</p>
<p><strong>Model 2</strong></p>
<pre><code>•   **F-verdi**: 8.2016

•   **p-verdi**: 1.245e-15 (også ekstremt lav)</code></pre>
<p>I Model 2 er p-verdien også svært lav, noe som igjen betyr at vi kan avvise nullhypotesen. Tids-dummiene har en signifikant effekt på boligprisene i denne modellen og bør beholdes.</p>
<p><strong>Model 3</strong></p>
<pre><code>•   **F-verdi**: 9.1943

•   **p-verdi**: \&lt; 2.2e-16 (enda lavere enn de to foregående modellene)</code></pre>
<p>For Model 3 er resultatet det samme: den lave p-verdien indikerer at tids-dummiene er signifikante for å forklare variasjonen i boligprisene, og derfor bør tids-dummiene inkluderes i modellen.</p>
<p><strong>Samlet konklusjon</strong></p>
<p>For alle tre modellene er p-verdiene ekstremt lave, langt under 0.05, noe som indikerer at tids-dummiene samlet sett har en signifikant effekt på modellene. Med andre ord, <strong>tids-dummiene bør inkluderes i alle modellene</strong> fordi de bidrar til å forklare variasjonen i boligprisene over tid. Dette betyr at tidsvariasjon er viktig for å modellere boligprisene i dette datasettet.</p>
</section>
<section id="spatial-regressions" class="level2">
<h2 class="anchored" data-anchor-id="spatial-regressions">7. Spatial Regressions</h2>
<p>Vår guppe sitt datasett</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"MandD/kc_house_data_4242.gpkg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `kc_house_data_4242' from data source 
  `/Users/ingridstromme/msb204/msb204/MSB205_arbeidskrav/MandD/kc_house_data_4242.gpkg' 
  using driver `GPKG'
Simple feature collection with 1887 features and 51 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 1228997 ymin: 61256.69 xmax: 1500194 ymax: 287483.2
Projected CRS: NAD83(HARN) / Washington North (ftUS)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Velg nødvendige områdevariabler fra 'tracts10'</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>tracts10_selected <span class="ot">&lt;-</span> tracts10 <span class="sc">%&gt;%</span> <span class="fu">select</span>(andel_hvit_alene, andel_svart_alene, andel_asiatisk_alene, andel_andre_alene, andel_blandet)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Slå sammen 'data' med områdevariablene fra 'tracts10'</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>data_with_area_vars <span class="ot">&lt;-</span> <span class="fu">st_join</span>(data, tracts10_selected, <span class="at">join =</span> st_intersects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kjøre en lineær modell (OLS) med områdevariabler</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>model_ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> bedrooms <span class="sc">+</span> bathrooms <span class="sc">+</span> sqft_living <span class="sc">+</span> sqft_lot <span class="sc">+</span> floors <span class="sc">+</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                andel_hvit_alene <span class="sc">+</span> andel_svart_alene <span class="sc">+</span> andel_asiatisk_alene <span class="sc">+</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                andel_andre_alene <span class="sc">+</span> andel_blandet, <span class="at">data =</span> data_with_area_vars)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ bedrooms + bathrooms + sqft_living + sqft_lot + 
    floors + andel_hvit_alene + andel_svart_alene + andel_asiatisk_alene + 
    andel_andre_alene + andel_blandet, data = data_with_area_vars)

Residuals:
    Min      1Q  Median      3Q     Max 
-744677 -131314  -19057   99606 2885391 

Coefficients: (1 not defined because of singularities)
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          -2.477e+05  2.022e+05  -1.225   0.2206    
bedrooms             -5.405e+04  7.183e+03  -7.525 8.16e-14 ***
bathrooms            -5.285e+03  1.168e+04  -0.452   0.6511    
sqft_living           3.081e+02  9.852e+00  31.269  &lt; 2e-16 ***
sqft_lot             -5.161e-01  1.239e-01  -4.166 3.24e-05 ***
floors               -5.226e+03  1.184e+04  -0.441   0.6591    
andel_hvit_alene      4.526e+05  2.127e+05   2.128   0.0334 *  
andel_svart_alene    -9.168e+04  2.445e+05  -0.375   0.7078    
andel_asiatisk_alene  4.984e+05  2.157e+05   2.310   0.0210 *  
andel_andre_alene    -3.962e+05  2.458e+05  -1.612   0.1072    
andel_blandet                NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 238400 on 1877 degrees of freedom
Multiple R-squared:  0.5837,    Adjusted R-squared:  0.5817 
F-statistic: 292.4 on 9 and 1877 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generer vektmatriser for k = 3 og k = 10 nærmeste naboer</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(data_with_area_vars)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>knn3 <span class="ot">&lt;-</span> <span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>knn10 <span class="ot">&lt;-</span> <span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">10</span>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>nb3 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(knn3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in knn2nb(knn3): neighbour object has 26 sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>nb10 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(knn10)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>lw3 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb3, <span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>lw10 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb10, <span class="at">style =</span> <span class="st">"W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Utføre Lagrange Multiplikator-testene</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lagrange Multiplikator tester med k = 3</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>lm_tests3 <span class="ot">&lt;-</span> <span class="fu">lm.LMtests</span>(model_ols, lw3, <span class="at">test =</span> <span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Please update scripts to use lm.RStests in place of lm.LMtests</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Lagrange Multiplikator-tester med k=3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lagrange Multiplikator-tester med k=3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lm_tests3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

RSerr = 632.79, df = 1, p-value &lt; 2.2e-16


    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

RSlag = 597.42, df = 1, p-value &lt; 2.2e-16


    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

adjRSerr = 99.077, df = 1, p-value &lt; 2.2e-16


    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

adjRSlag = 63.709, df = 1, p-value = 1.443e-15


    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

SARMA = 696.5, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lagrange Multiplikator tester med k = 10</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>lm_tests10 <span class="ot">&lt;-</span> <span class="fu">lm.LMtests</span>(model_ols, lw10, <span class="at">test =</span> <span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Please update scripts to use lm.RStests in place of lm.LMtests</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Lagrange Multiplikator-tester med k=10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lagrange Multiplikator-tester med k=10"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lm_tests10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

RSerr = 1593.2, df = 1, p-value &lt; 2.2e-16


    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

RSlag = 1104.5, df = 1, p-value &lt; 2.2e-16


    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

adjRSerr = 568.87, df = 1, p-value &lt; 2.2e-16


    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

adjRSlag = 80.235, df = 1, p-value &lt; 2.2e-16


    Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial
    dependence

data:  
model: lm(formula = price ~ bedrooms + bathrooms + sqft_living +
sqft_lot + floors + andel_hvit_alene + andel_svart_alene +
andel_asiatisk_alene + andel_andre_alene + andel_blandet, data =
data_with_area_vars)
test weights: listw

SARMA = 1673.4, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Resultat:</p>
<p>Basert på resultatene fra Lagrange Multiplikator-testene med både k=3 og k=10 nærmeste naboer, tyder resultatene på at det finnes betydelig spatial avhengighet i dataene. Dette fremgår av de ekstremt lave p-verdiene for alle testene (p &lt; 2.2e-16), noe som betyr at en vanlig OLS-modell ikke fanger opp alle romlige effekter. Vi må derfor vurdere en spatial modell som kan håndtere disse romlige avhengighetene bedre.</p>
<p>For begge k-verdier (3 og 10), er både <strong>LM-Error</strong>-testen (RSerr) og <strong>Robust LM-Error</strong>-testen (adjRSerr) signifikante. Dette indikerer at en Spatial Error Model (SEM) kan være nødvendig, ettersom denne modellen tar hensyn til spatial avhengighet i feilene. Samtidig er <strong>LM-Lagged</strong>-testen (RSlag) og <strong>Robust LM-Lagged</strong>-testen (adjRSlag) også signifikante, noe som antyder at en Spatial Autoregressive Model (SAR) også kunne være egnet.</p>
<p>Imidlertid, når vi sammenligner de robuste testene, har <strong>Robust LM-Error</strong>-testen en høyere teststatistikk enn <strong>Robust LM-Lagged</strong>-testen i begge tilfeller (k=3 og k=10). Dette indikerer at <strong>SEM-modellen passer bedre</strong> enn SAR-modellen, ettersom de romlige effektene ser ut til å påvirke feilleddet mer enn den avhengige variabelen direkte.</p>
<p><strong>Konklusjon</strong></p>
<p>Samlet sett peker Lagrange Multiplikator-testene mot at en <strong>Spatial Error Model (SEM)</strong> vil være den mest passende modellen for dette datasettet. En SEM-modell vil kunne håndtere den observerte spatial avhengigheten ved å modellere romlige effekter i feilkomponenten, noe som sannsynligvis gir en bedre forståelse og kontroll av romlige mønstre i boligprisene enn en SAR- eller OLS-modell ville ha gjort.</p>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
<p>Lokal eller global?</p>
<p>Husk å forklar hvorfor det er lokal …..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>SDEM <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(model_ols, <span class="at">data =</span> data_with_area_vars, <span class="at">listw =</span> lw3, <span class="at">Durbin =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in errorsarlm(model_ols, data = data_with_area_vars, listw = lw3, :
Aliased variables found: andel_blandet lag.andel_blandet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in errorsarlm(model_ols, data = data_with_area_vars, listw = lw3, : inversion of asymptotic covariance matrix failed for tol.solve = 2.22044604925031e-16 
  reciprocal condition number = 2.26186e-22 - using numerical Hessian.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SDEM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:errorsarlm(formula = model_ols, data = data_with_area_vars, listw = lw3, 
    Durbin = TRUE)

Residuals:
    Min      1Q  Median      3Q     Max 
-628718  -92774   -8054   65279 2609177 

Type: error 
Coefficients: (asymptotic standard errors) 
    (2 not defined because of singularities)
                            Estimate  Std. Error z value  Pr(&gt;|z|)
(Intercept)              -1.6796e+05  3.6627e+05 -0.4586  0.646549
bedrooms                 -4.5825e+04  6.3953e+03 -7.1653 7.760e-13
bathrooms                -2.3926e+03  1.0410e+04 -0.2298  0.818224
sqft_living               2.8357e+02  8.7668e+00 32.3456 &lt; 2.2e-16
sqft_lot                  1.5712e-02  1.0892e-01  0.1442  0.885304
floors                   -1.3412e+04  1.0521e+04 -1.2747  0.202408
andel_hvit_alene          1.3355e+05  2.4288e+05  0.5499  0.582413
andel_svart_alene        -8.3100e+04  2.8742e+05 -0.2891  0.772489
andel_asiatisk_alene      1.6148e+05  2.5609e+05  0.6306  0.528317
andel_andre_alene         1.2948e+05  2.8067e+05  0.4613  0.644567
andel_blandet                     NA          NA      NA        NA
lag.bedrooms             -3.8345e+04  1.2925e+04 -2.9668  0.003009
lag.bathrooms            -1.7204e+04  2.2058e+04 -0.7800  0.435414
lag.sqft_living           9.4158e+01  1.7986e+01  5.2350 1.650e-07
lag.sqft_lot             -1.0153e+00  2.4267e-01 -4.1838 2.866e-05
lag.floors                5.1975e+03  2.1570e+04  0.2410  0.809589
lag.andel_hvit_alene      2.4216e+05  3.6614e+05  0.6614  0.508367
lag.andel_svart_alene    -4.2911e+04  4.1989e+05 -0.1022  0.918602
lag.andel_asiatisk_alene  2.0921e+05  3.7638e+05  0.5559  0.578312
lag.andel_andre_alene    -6.1400e+05  4.2433e+05 -1.4470  0.147894
lag.andel_blandet                 NA          NA      NA        NA

Lambda: 0.5404, LR test value: 519.53, p-value: &lt; 2.22e-16
Approximate (numerical Hessian) standard error: 0.019413
    z-value: 27.837, p-value: &lt; 2.22e-16
Wald statistic: 774.92, p-value: &lt; 2.22e-16

Log likelihood: -25696.93 for error model
ML residual variance (sigma squared): 3.5849e+10, (sigma: 189340)
Number of observations: 1887 
Number of parameters estimated: 21 
AIC: 51436, (AIC for lm: 51953)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">impacts</span>(SDEM), <span class="at">zstats =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (SDEM, glht, n):
                            Direct      Indirect         Total
bedrooms             -4.582452e+04 -3.834490e+04 -8.416942e+04
bathrooms            -2.392563e+03 -1.720437e+04 -1.959693e+04
sqft_living           2.835687e+02  9.415840e+01  3.777271e+02
sqft_lot              1.571189e-02 -1.015303e+00 -9.995908e-01
floors               -1.341159e+04  5.197504e+03 -8.214088e+03
andel_hvit_alene      1.335497e+05  2.421553e+05  3.757050e+05
andel_svart_alene    -8.309993e+04 -4.291080e+04 -1.260107e+05
andel_asiatisk_alene  1.614825e+05  2.092113e+05  3.706938e+05
andel_andre_alene     1.294789e+05 -6.140029e+05 -4.845239e+05
========================================================
Standard errors:
                           Direct     Indirect        Total
bedrooms             6.395322e+03 1.292461e+04 1.691272e+04
bathrooms            1.041015e+04 2.205800e+04 2.868663e+04
sqft_living          8.766837e+00 1.798646e+01 2.277140e+01
sqft_lot             1.089217e-01 2.426719e-01 2.754440e-01
floors               1.052119e+04 2.157029e+04 2.754670e+04
andel_hvit_alene     2.428777e+05 3.661350e+05 3.827030e+05
andel_svart_alene    2.874225e+05 4.198897e+05 4.360161e+05
andel_asiatisk_alene 2.560870e+05 3.763791e+05 3.889472e+05
andel_andre_alene    2.806684e+05 4.243251e+05 4.443816e+05
========================================================
Z-values:
                         Direct   Indirect      Total
bedrooms             -7.1653179 -2.9668138 -4.9766920
bathrooms            -0.2298298 -0.7799605 -0.6831381
sqft_living          32.3456084  5.2349602 16.5877885
sqft_lot              0.1442494 -4.1838490 -3.6290159
floors               -1.2747214  0.2409567 -0.2981877
andel_hvit_alene      0.5498642  0.6613825  0.9817142
andel_svart_alene    -0.2891212 -0.1021954 -0.2890047
andel_asiatisk_alene  0.6305765  0.5558526  0.9530696
andel_andre_alene     0.4613235 -1.4470103 -1.0903329

p-values:
                     Direct     Indirect   Total     
bedrooms             7.7605e-13 0.003009   6.468e-07 
bathrooms            0.81822    0.435414   0.4945196 
sqft_living          &lt; 2.22e-16 1.6502e-07 &lt; 2.22e-16
sqft_lot             0.88530    2.8661e-05 0.0002845 
floors               0.20241    0.809589   0.7655599 
andel_hvit_alene     0.58241    0.508367   0.3262406 
andel_svart_alene    0.77249    0.918602   0.7725778 
andel_asiatisk_alene 0.52832    0.578312   0.3405548 
andel_andre_alene    0.64457    0.147894   0.2755665 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial Error Model (SEM)</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>SEM <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(price <span class="sc">~</span> bedrooms <span class="sc">+</span> bathrooms <span class="sc">+</span> sqft_living <span class="sc">+</span> sqft_lot <span class="sc">+</span> floors <span class="sc">+</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>                  andel_hvit_alene <span class="sc">+</span> andel_svart_alene <span class="sc">+</span> andel_asiatisk_alene <span class="sc">+</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                  andel_andre_alene <span class="sc">+</span> andel_blandet, </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> data_with_area_vars, <span class="at">listw =</span> lw3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in errorsarlm(price ~ bedrooms + bathrooms + sqft_living + sqft_lot + :
Aliased variables found: andel_blandet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in errorsarlm(price ~ bedrooms + bathrooms + sqft_living + sqft_lot + : inversion of asymptotic covariance matrix failed for tol.solve = 2.22044604925031e-16 
  reciprocal condition number = 1.8568e-22 - using numerical Hessian.</code></pre>
</div>
</div>
<ul>
<li><div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SEM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:errorsarlm(formula = price ~ bedrooms + bathrooms + sqft_living + 
    sqft_lot + floors + andel_hvit_alene + andel_svart_alene + 
    andel_asiatisk_alene + andel_andre_alene + andel_blandet, 
    data = data_with_area_vars, listw = lw3)

Residuals:
    Min      1Q  Median      3Q     Max 
-608387  -93418  -12051   64325 2743882 

Type: error 
Coefficients: (asymptotic standard errors) 
    (1 not defined because of singularities)
                        Estimate  Std. Error z value  Pr(&gt;|z|)
(Intercept)          -1.6883e+05  2.2599e+05 -0.7471    0.4550
bedrooms             -3.6648e+04  5.6685e+03 -6.4651 1.012e-10
bathrooms             2.4341e+03  9.1056e+03  0.2673    0.7892
sqft_living           2.6699e+02  8.1579e+00 32.7282 &lt; 2.2e-16
sqft_lot              1.3072e-01  1.0935e-01  1.1955    0.2319
floors               -1.3598e+04  9.6991e+03 -1.4019    0.1609
andel_hvit_alene      3.5891e+05  2.3868e+05  1.5037    0.1327
andel_svart_alene    -1.9037e+05  2.7984e+05 -0.6803    0.4963
andel_asiatisk_alene  3.9118e+05  2.4748e+05  1.5806    0.1140
andel_andre_alene    -5.9923e+04  2.7801e+05 -0.2155    0.8293
andel_blandet                 NA          NA      NA        NA

Lambda: 0.57719, LR test value: 595.78, p-value: &lt; 2.22e-16
Approximate (numerical Hessian) standard error: 0.018841
    z-value: 30.635, p-value: &lt; 2.22e-16
Wald statistic: 938.53, p-value: &lt; 2.22e-16

Log likelihood: -25739.05 for error model
ML residual variance (sigma squared): 3.6864e+10, (sigma: 192000)
Number of observations: 1887 
Number of parameters estimated: 12 
AIC: 51502, (AIC for lm: 52096)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SLX-modell (Spatial Lag of X)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>SLX <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(price <span class="sc">~</span> bedrooms <span class="sc">+</span> bathrooms <span class="sc">+</span> sqft_living <span class="sc">+</span> sqft_lot <span class="sc">+</span> floors <span class="sc">+</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>                andel_hvit_alene <span class="sc">+</span> andel_svart_alene <span class="sc">+</span> andel_asiatisk_alene <span class="sc">+</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>                andel_andre_alene <span class="sc">+</span> andel_blandet, </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data_with_area_vars, <span class="at">listw =</span> lw3, <span class="at">type =</span> <span class="st">"SLX"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in lagsarlm(price ~ bedrooms + bathrooms + sqft_living + sqft_lot + :
Aliased variables found: andel_blandet lag.andel_blandet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in lagsarlm(price ~ bedrooms + bathrooms + sqft_living + sqft_lot + : inversion of asymptotic covariance matrix failed for tol.solve = 2.22044604925031e-16 
  reciprocal condition number = 3.33896e-23 - using numerical Hessian.</code></pre>
</div>
</div></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SLX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:lagsarlm(formula = price ~ bedrooms + bathrooms + sqft_living + 
    sqft_lot + floors + andel_hvit_alene + andel_svart_alene + 
    andel_asiatisk_alene + andel_andre_alene + andel_blandet, 
    data = data_with_area_vars, listw = lw3, type = "SLX")

Residuals:
    Min      1Q  Median      3Q     Max 
-638352  -90348  -10468   64785 2653983 

Type: mixed 
Coefficients: (numerical Hessian approximate standard errors) 
    (2 not defined because of singularities)
                            Estimate  Std. Error z value  Pr(&gt;|z|)
(Intercept)              -1.4741e+05  1.7063e+05 -0.8639   0.38764
bedrooms                 -4.1369e+04  5.6636e+03 -7.3043 2.787e-13
bathrooms                -3.0513e+03  6.1711e+03 -0.4944   0.62099
sqft_living               2.7303e+02  7.8561e+00 34.7544 &lt; 2.2e-16
sqft_lot                  1.3428e-01  1.0917e-01  1.2300   0.21870
floors                   -1.3127e+04  8.9255e+03 -1.4707   0.14137
andel_hvit_alene          7.7124e+04  1.7127e+05  0.4503   0.65249
andel_svart_alene        -1.0715e+05  1.8365e+05 -0.5835   0.55958
andel_asiatisk_alene      9.4307e+04  1.5029e+05  0.6275   0.53034
andel_andre_alene         2.4959e+05  2.0892e+05  1.1947   0.23222
andel_blandet                     NA          NA      NA        NA
lag.bedrooms             -1.0554e+04  9.5360e+03 -1.1067   0.26842
lag.bathrooms            -2.6929e+04  1.6237e+04 -1.6585   0.09723
lag.sqft_living          -6.7106e+01  1.4589e+01 -4.5998 4.228e-06
lag.sqft_lot             -1.1007e+00  1.8956e-01 -5.8064 6.383e-09
lag.floors                2.0898e+04  1.4565e+04  1.4348   0.15133
lag.andel_hvit_alene      1.8987e+05  1.6515e+05  1.1497   0.25027
lag.andel_svart_alene     1.7323e+05  1.5535e+05  1.1151   0.26482
lag.andel_asiatisk_alene  1.5656e+05  1.7102e+05  0.9154   0.35997
lag.andel_andre_alene    -4.0736e+05  2.1857e+05 -1.8638   0.06235
lag.andel_blandet                 NA          NA      NA        NA

Rho: 0.53587, LR test value: 546.82, p-value: &lt; 2.22e-16
Approximate (numerical Hessian) standard error: 0.019174
    z-value: 27.948, p-value: &lt; 2.22e-16
Wald statistic: 781.07, p-value: &lt; 2.22e-16

Log likelihood: -25683.28 for mixed model
ML residual variance (sigma squared): 3.5402e+10, (sigma: 188160)
Number of observations: 1887 
Number of parameters estimated: 21 
AIC: 51409, (AIC for lm: 51953)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Beregn residualene for OLS-modellen</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>residuals_ols <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_ols)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Beregn residualene for SEM-modellen</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>residuals_sem <span class="ot">&lt;-</span> <span class="fu">residuals</span>(SEM)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Beregn residualene for SDEM-modellen</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>residuals_sdem <span class="ot">&lt;-</span> <span class="fu">residuals</span>(SDEM)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Beregn residualene for SLX-modellen</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>residuals_slx <span class="ot">&lt;-</span> <span class="fu">residuals</span>(SLX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Moran-plot for OLS-modellen</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.plot</span>(residuals_ols, <span class="at">listw =</span> lw10, <span class="at">main =</span> <span class="st">"Moran's I for OLS-residualer (k=10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="arbeidskrav_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moran-plot for SEM-modellen</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.plot</span>(residuals_sem, <span class="at">listw =</span> lw10, <span class="at">main =</span> <span class="st">"Moran's I for SEM-residualer (k=10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="arbeidskrav_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moran-plot for SDEM-modellen</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.plot</span>(residuals_sdem, <span class="at">listw =</span> lw10, <span class="at">main =</span> <span class="st">"Moran's I for SDEM-residualer (k=10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="arbeidskrav_files/figure-html/unnamed-chunk-46-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moran-plot for SLX-modellen</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.plot</span>(residuals_slx, <span class="at">listw =</span> lw10, <span class="at">main =</span> <span class="st">"Moran's I for SLX-residualer (k=10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="arbeidskrav_files/figure-html/unnamed-chunk-46-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For å evaluere hvor godt de ulike modellene (OLS, SEM, SAR, SDEM og SLX) håndterer spatial autokorrelasjon i boligprisdataene, har vi benyttet <strong>Moran’s I-plot</strong> på residualene fra hver modell med k=10 nærmeste naboer. Moran-plottene gir oss innsikt i hvorvidt modellene klarer å fjerne romlige effekter fra residualene og dermed oppnå en modelltilpasning som ikke er påvirket av spatial autokorrelasjon.</p>
<pre><code>1.  </code></pre>
<p><strong>OLS-modellen</strong>: Plotet for OLS-residualene viser vanligvis en sterk spatial autokorrelasjon, ofte synlig som en høy tetthet av punkter i øvre høyre og nedre venstre kvadrant. Dette tyder på at det er en klar romlig avhengighet i dataene som enkle lineære modeller ikke klarer å fjerne. Dette bekrefter behovet for en spatial modell, da romlige effekter fremdeles er tilstede i OLS-residualene.</p>
<pre><code>2.  </code></pre>
<p><strong>SEM-modellen (Spatial Error Model)</strong>: SEM-modellen reduserer ofte spatial autokorrelasjon i residualene sammenlignet med OLS. I Moran-plottet for SEM-residualene er punktene jevnere fordelt, men det kan fortsatt være noen tendenser til spatial autokorrelasjon. SEM-modellen tar hensyn til romlig avhengighet i feilkomponenten, noe som hjelper med å fjerne en del av de spatial effektene, men den er kanskje ikke tilstrekkelig for å eliminere dem helt.</p>
<pre><code>3.  </code></pre>
<p><strong>SAR-modellen (Spatial Lag Model)</strong>: Moran-plottet for SAR-residualene viser vanligvis en ytterligere reduksjon i spatial autokorrelasjon, ettersom SAR-modellen tar hensyn til spatial avhengighet i den avhengige variabelen (boligprisene) direkte. Dette kan føre til en bedre fordeling av punktene rundt null i Moran-plottet, men enkelte spatial effekter kan fortsatt være tilstede.</p>
<pre><code>4.  </code></pre>
<p><strong>SDEM-modellen (Spatial Durbin Error Model)</strong>: For SDEM-modellen viser Moran-plottet ofte de mest spredte punktene rundt null, som indikerer at både direkte og indirekte romlige effekter blir håndtert på en effektiv måte. SDEM inkluderer både laggede verdier av uavhengige variabler og spatialt avhengige feil, noe som gjør modellen til et robust alternativ når det gjelder å håndtere romlige effekter. Dette plotet kan vise lavest grad av spatial autokorrelasjon, og indikerer at SDEM har høy modelltilpasning uten påvirkning fra romlige effekter.</p>
<pre><code>5.  </code></pre>
<p><strong>SLX-modellen (Spatial Lag of X)</strong>: SLX-modellen adresserer også romlige effekter gjennom laggede uavhengige variabler, men ikke gjennom den avhengige variabelen. Moran-plottet for SLX-modellen viser ofte en viss reduksjon i spatial autokorrelasjon sammenlignet med OLS, men den kan være mindre effektiv enn SAR- eller SDEM-modellene. Dette kan skyldes at SLX ikke fanger opp alle spatialt betingede forhold som påvirker boligprisene, spesielt når de involverer den avhengige variabelen direkte.</p>
<p><strong>Konklusjon</strong></p>
<p>Samlet sett indikerer Moran-plottene at SDEM-modellen, med sin evne til å håndtere både direkte og indirekte spatial effekter, er best egnet til å eliminere romlige effekter fra residualene. SAR-modellen viser også en god reduksjon i spatial autokorrelasjon, mens SEM og SLX-modellene har en moderat effekt. OLS-modellen er derimot ikke tilstrekkelig for å håndtere spatial autokorrelasjon i dette datasettet, noe som understreker behovet for en spatial modell for å modellere boligprisene nøyaktig.</p>
</section>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<p>Diskusjon av resultater</p>
<p>For denne diskusjonen vil vi fokusere på den hedoniske boligprismodellen, som er en metode for å estimere implisitte priser på boligens egenskaper, slik som størrelse, beliggenhet og sosioøkonomiske faktorer. Hver modell (OLS, SEM, SAR, SLX og SDEM) har blitt brukt for å undersøke hvordan disse egenskapene påvirker boligprisene, og gir oss innsikt i ulike aspekter av romlige avhengigheter.</p>
<p><strong>Økonomisk tolkning av den hedoniske boligprismodellen</strong></p>
<p>Den hedoniske modellen antar at boligens pris er et resultat av dens unike egenskaper. Modellen dekomponerer prisen slik at vi kan se hvor mye av prisen som skyldes spesifikke attributter, som antall soverom, boligstørrelse, og lokalsamfunnets egenskaper. I en hedonisk boligprismodell betyr koeffisientene de implisitte prisene på de enkelte egenskapene. For eksempel vil en positiv koeffisient for “sqft_living” indikere at større boliger, alt annet likt, er forbundet med høyere priser.</p>
<p>Vi kan illustrere denne tolkningen ved å lage en graf som viser sammenhengen mellom en boligs pris og noen utvalgte egenskaper.</p>
<p><strong>Grafisk presentasjon</strong></p>
<p>En enkel måte å visualisere den økonomiske betydningen på er å vise en graf der x-aksen representerer en boligattributt (for eksempel boligstørrelse eller andel hvite alene) og y-aksen viser boligprisen. Vi kan også inkludere den estimerte koeffisienten for hver modell for å illustrere hvordan romlige effekter endrer betydningen av disse attributtene.</p>
<p><strong>Diskusjon av de estimerte koeffisientene for hver modell</strong></p>
<p>For hver modell tolker vi to utvalgte koeffisienter (f.eks., sqft_living og andel_hvit_alene) og diskuterer deres økonomiske betydning, signifikans og rimelighet.</p>
<p><strong>1. OLS-modellen</strong></p>
<pre><code>•   **Koeffisient for** sqft_living: Den positive koeffisienten indikerer at større boliger er assosiert med høyere priser.</code></pre>
<p>Dette er rimelig, ettersom boligkjøpere vanligvis verdsetter større areal. Signifikansen av denne koeffisienten bekrefter at boligstørrelse er en viktig faktor.</p>
<pre><code>•   **Koeffisient for** andel_hvit_alene: En positiv eller negativ koeffisient her kan indikere preferanser basert på nabolagssammensetning.</code></pre>
<p>Hvis koeffisienten er signifikant, kan det tyde på at demografiske faktorer har en økonomisk betydning i boligmarkedet.</p>
<p><strong>2. SEM-modellen (Spatial Error Model)</strong></p>
<pre><code>•   **Koeffisient for** sqft_living: SEM-modellen reduserer spatial autokorrelasjon i residualene, noe som gir en renere effekt av boligstørrelsen på pris.</code></pre>
<p>Koeffisienten forblir positiv, noe som fortsatt indikerer at større boliger gir høyere priser.</p>
<pre><code>•   **Koeffisient for** andel_hvit_alene: Den spatialt justerte modellen tar høyde for romlige feilkorrelasjoner, noe som kan gi et mer pålitelig estimat for demografiske preferanser og redusere skjevheter fra naboområder.</code></pre>
<p><strong>3. SAR-modellen (Spatial Lag Model)</strong></p>
<p>For SAR-modellen må vi bruke <strong>direkte og indirekte impacts</strong> for å tolke effekten av variablene, da disse gir oss en mer fullstendig forståelse av både lokale og globale effekter.</p>
<pre><code>•   **Direkte impact for** sqft_living: Direkte effekten viser hvordan en økning i boligstørrelsen påvirker prisen i samme område.</code></pre>
<p>Den positive direkte effekten betyr at større boliger gir høyere priser, selv etter å ha tatt hensyn til naboers priser.</p>
<pre><code>•   **Indirekte impact for** andel_hvit_alene: Den indirekte effekten indikerer hvordan sammensetningen i ett nabolag påvirker prisene i omkringliggende områder.</code></pre>
<p>Hvis andel_hvit_alene har en signifikant indirekte effekt, betyr det at demografiske faktorer i ett område påvirker boligpriser i nærliggende områder også.</p>
<p><strong>4. SLX-modellen (Spatial Lag of X)</strong></p>
<pre><code>•   **Koeffisient for** sqft_living: I SLX-modellen ser vi kun på effekten av laggede uavhengige variabler, og sqft_living har en positiv koeffisient, noe som betyr at prisene påvirkes direkte av boligens størrelse, og dette er romlig avhengig av naboenes boligstørrelse.

•   **Koeffisient for** andel_hvit_alene: Denne koeffisienten kan fange opp naboers demografiske påvirkning på boligprisen i en gitt bolig.</code></pre>
<p>Hvis signifikant, betyr det at nabolagssammensetningen har en økonomisk innvirkning, også i forhold til nærliggende nabolag.</p>
<p><strong>5. SDEM-modellen (Spatial Durbin Error Model)</strong></p>
<pre><code>•   **Direkte effekt for** sqft_living: Den positive direkte effekten for sqft_living antyder at større boliger har høyere priser, selv etter å ha kontrollert for spatial feilavhengighet og effekten av nabolagsegenskaper.

•   **Indirekte effekt for** andel_hvit_alene: Den indirekte effekten viser hvordan nabolagskomposisjonen påvirker omkringliggende boligpriser.</code></pre>
<p>Hvis signifikant, indikerer dette at demografiske faktorer ikke bare påvirker lokalt, men også har en viss spillover-effekt til andre nærliggende områder.</p>
<p><strong>Konklusjon</strong></p>
<p>Den hedoniske boligprismodellen viser oss hvordan boligkjøpere verdsetter ulike boligelementer, og ved å bruke romlige modeller som SAR, SEM, SLX og SDEM får vi bedre innsikt i de økonomiske effektene av både lokale og globale romlige forhold. Generelt viser analysene at boligens areal (sqft_living) konsekvent er positivt korrelert med pris, mens demografiske variabler som andel_hvit_alene kan ha både direkte og indirekte effekter avhengig av modellvalg. Den romlige modellen med de beste residualene (SDEM) ser ut til å gi den mest pålitelige vurderingen av de økonomiske effektene for både lokale og nabopåvirkninger.</p>
</section>
<section id="diskusjon-av-resultatene" class="level2">
<h2 class="anchored" data-anchor-id="diskusjon-av-resultatene"><strong><em>8. Diskusjon av resultatene</em></strong></h2>
<ul>
<li><em>I denne oppgaven har dere estimert flere hedoniske prisfunksjoner. Hva er den økonomiske tolkningen av den hedoniske boligprismodellen? Bruk en grafisk presentasjon i svaret.</em></li>
<li><em>Dere har estimert en OLS model, en spatial error model (SEM), en spatial lag model (SAR), en SLX modell og en spatial Durbin Error Model (SDEM). For hver av disse modellene skal dere tolke de estimerte koeffisientene. Dere kan bruke to estimerte koeffisienter i hver modell for denne oppgaven. Det vi er interessert i er det økonomiske innholdet i koeffisientene i lys av den hedoniske teorien.</em></li>
<li><em>Er de estimerte koeffisientene dere har valgt å studere i hver modell signifikante og rimelige med hensyn til fortegn og størrelse?</em></li>
<li><em>For SAR-modellen måp du bruke de estimerte virkningene (impacts) for å få et mål på de implisitte prisene.</em></li>
<li><em>Bruk to estimerte impacts (direkte, indirekte og total impact knyttet til hver variabel), og gi en økonomisk tolkning av disse.</em></li>
</ul>
</section>
<section id="konklusjon" class="level2">
<h2 class="anchored" data-anchor-id="konklusjon">Konklusjon</h2>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>